---
testName: "ProblemSectionTest"
testCase:
  eCR-problem-withOnlyTriggerCode:
    testData:
      ClientDataToBeSaved: "R4/Misc/ClientDetails/ClientDataEntry1.json"
      SystemLaunchPayload: "R4/Misc/SystemLaunchPayload/systemLaunchRequest.json"
      BaseXPath: "/ClinicalDocument/component/structuredBody/component[1]/section/"
    resourceMappingData:
      Patient:
      - params: "12742571"
        responseFilePath: "R4/Patient/Patient_12742571.json"
      Encounter:
      - params: "97953900"
        responseFilePath: "R4/Encounter/Encounter_withOneParticipant.json"
      Practitioner:
      - params: "11817978"
        responseFilePath: "R4/Practitioner/Practitioner_11817978.json"
      Organization:
      - params: "675844"
        responseFilePath: "R4/Organization/Organization.json"
      Condition:
      - params:
          patient: "12742571"
        responseFilePath: "R4/Condition/ConditionBundle_d2572364249.json"
    otherMappingData:
      metadata: "R4/Misc/MetaData_r4.json"
      token: "R4/Misc/AccessToken.json"
      default: "R4/Misc/NoDataFound_Default.json"
    validate:
    - xPath: ""
      'templateId[1]/@root': "2.16.840.1.113883.10.20.22.2.5.1"
      'templateId[2]/@root': "2.16.840.1.113883.10.20.22.2.5.1"
      'templateId[2]/@extension': "2015-08-01"
      'code/@code': "11450-4"
      'code/@codeSystem': "2.16.840.1.113883.6.1"
      'code/@codeSystemName': "LOINC"
      'code/@displayName': "PROBLEM LIST"
      'title': "PROBLEMS - DIAGNOSES"
    - xPath: "text/table/thead/tr/th"
      count: 2
    - xPath: "text/table/tbody/tr"
      count: 1
    - xPath: "text/table/tbody/tr[1]/td"
      count: 2
    - xPath: "text/table/"
      'thead/tr/th[1]': "Problem or Diagnosis"
      'thead/tr/th[2]': "Problem Status"
      'tbody/tr[1]/td[1]/content': "Disease caused by 2019-nCoV"
      'tbody/tr[1]/td[2]/content': "Active"
    - xPath: "entry"
      count: 1
    - xPath: "entry[1]/"
      '@typeCode': "DRIV"
    - xPath: "entry[1]/act/templateId"
      count: 2
    - xPath: "entry[1]/act/id"
      count: 1
    - xPath: "entry[1]/act/"
      '@classCode': "ACT"
      '@moodCode': "EVN"
      'templateId[1]/@root': "2.16.840.1.113883.10.20.22.4.3"
      'templateId[2]/@root': "2.16.840.1.113883.10.20.22.4.3"
      'templateId[2]/@extension': "2015-08-01"
#      'id[1]/@root': ""
      'code/@code': "CONC"
      'code/@codeSystem': "2.16.840.1.113883.5.6"
      'code/@codeSystemName': "HL7ActClass"
      'code/@displayName': "Concern"
      'statusCode/@code': "active"
#      'effectiveTime/low/@value': "20200514"
    - xPath: "entry[1]/act/entryRelationship"
      count: 2
    - xPath: "entry[1]/act/entryRelationship[1]/"
      '@typeCode': "SUBJ"
      'observation/@classCode': "OBS"
      'observation/@moodCode': "EVN"
    - xPath: "entry[1]/act/entryRelationship[1]/observation/templateId"
      count: 2
    - xPath: "entry[1]/act/entryRelationship[1]/observation/id"
      count: 1
    - xPath: "entry[1]/act/entryRelationship[1]/observation/"
      'templateId[1]/@root': "2.16.840.1.113883.10.20.22.4.4"
      'templateId[2]/@root': "2.16.840.1.113883.10.20.22.4.4"
      'templateId[2]/@extension': "2015-08-01"
      'id[1]/@root': "2.16.840.1.113883.1.1.1.1"
#      'id[1]/@extension': "d2572364249"
      'code/@code': "282291009"
      'code/@codeSystem': "2.16.840.1.113883.6.96"
      'code/@codeSystemName': "SNOMED-CT"
      'code/@displayName': "Diagnosis"
      'code/translation/@code': "29308-4"
      'code/translation/@codeSystem': "2.16.840.1.113883.6.1"
      'code/translation/@codeSystemName': "LOINC"
      'code/translation/@displayName': "Diagnosis"
      'statusCode/@code': "completed"
#      'effectiveTime/low/@value': "20200514"
    - xPath: "entry[1]/act/entryRelationship[1]/observation/value/translation"
      count: 1
    - xPath: "entry[1]/act/entryRelationship[1]/observation/value/"
      '@type': "CD"
      '@code': "840539006"
      '@codeSystem': "2.16.840.1.113883.6.96"
      '@codeSystemName': "sct"
      '@displayName': "Disease caused by 2019-nCoV"
      'translation/@code': "U07.1"
      'translation/@codeSystem': "2.16.840.1.113883.6.90"
      'translation/@codeSystemName': "icd-10-cm"
      'translation/@displayName': "2019-nCoV acute respiratory disease"
    - xPath: "entry[1]/act/entryRelationship[2]/"
      '@typeCode': "RSON"
      'observation/@classCode': "OBS"
      'observation/@moodCode': "EVN"
      'observation/@negationInd': "false"
    - xPath: "entry[1]/act/entryRelationship[2]/observation/templateId"
      count: 3
    - xPath: "entry[1]/act/entryRelationship[2]/observation/id"
      count: 1
    - xPath: "entry[1]/act/entryRelationship[2]/observation/"
      'templateId[1]/@root': "2.16.840.1.113883.10.20.22.4.4"
      'templateId[2]/@root': "2.16.840.1.113883.10.20.22.4.4"
      'templateId[2]/@extension': "2015-08-01"
      'templateId[3]/@root': "2.16.840.1.113883.10.20.15.2.3.3"
      'templateId[3]/@extension': "2016-12-01"
      'id[1]/@root': "2.16.840.1.113883.1.1.1.1"
#      'id[1]/@extension': "d2572364249"
      'code/@code': "282291009"
      'code/@codeSystem': "2.16.840.1.113883.6.96"
      'code/@codeSystemName': "SNOMED-CT"
      'code/@displayName': "Diagnosis"
      'code/translation/@code': "29308-4"
      'code/translation/@codeSystem': "2.16.840.1.113883.6.1"
      'code/translation/@codeSystemName': "LOINC"
      'code/translation/@displayName': "Diagnosis"
      'statusCode/@code': "completed"
#      'effectiveTime/low/@value': "20200514"
    - xPath: "entry[1]/act/entryRelationship[2]/observation/value/"
      '@type': "CD"
      '@code': "U07.1"
      '@codeSystem': "2.16.840.1.113883.6.90"
      '@codeSystemName': "icd-10-cm"
#      '@displayName': "Disease caused by 2019-nCoV"
#      '@valueSet': "2.16.840.1.114222.4.11.7508"
#      '@valueSetVersion': "2020-07-09"
  eCR-problem-withTwoTriggerCode:
    testData:
      ClientDataToBeSaved: "R4/Misc/ClientDetails/ClientDataEntry1.json"
      SystemLaunchPayload: "R4/Misc/SystemLaunchPayload/systemLaunchRequest.json"
      BaseXPath: "/ClinicalDocument/component/structuredBody/component[1]/section/"
    resourceMappingData:
      Patient:
      - params: "12742571"
        responseFilePath: "R4/Patient/Patient_12742571.json"
      Encounter:
      - params: "97953900"
        responseFilePath: "R4/Encounter/Encounter_withOneParticipant.json"
      Practitioner:
      - params: "11817978"
        responseFilePath: "R4/Practitioner/Practitioner_11817978.json"
      Organization:
      - params: "675844"
        responseFilePath: "R4/Organization/Organization.json"
      Condition:
      - params:
          patient: "12742571"
        responseFilePath: "R4/Condition/ConditionWithTwoTriggerCodes.json"
    otherMappingData:
      metadata: "R4/Misc/MetaData_r4.json"
      token: "R4/Misc/AccessToken.json"
      default: "R4/Misc/NoDataFound_Default.json"
    validate:
    - xPath: "text/table/tbody/tr"
      count: 2
    - xPath: "text/table/"
      'tbody/tr[2]/td[1]/content': "Seasonal allergy (disorder)"
      'tbody/tr[2]/td[2]/content': "Active"
      #'tbody/tr[5]/td[1]/content': "Disease caused by 2019-nCoV"
      #'tbody/tr[5]/td[2]/content': "Active"
    - xPath: "entry"
      count: 2
    - xPath: "entry[1]/"
      '@typeCode': "DRIV"
    - xPath: "entry[1]/act/templateId"
      count: 2
    - xPath: "entry[1]/act/id"
      count: 1
    - xPath: "entry[1]/act/"
      '@classCode': "ACT"
      '@moodCode': "EVN"
      'templateId[1]/@root': "2.16.840.1.113883.10.20.22.4.3"
      'templateId[2]/@root': "2.16.840.1.113883.10.20.22.4.3"
      'templateId[2]/@extension': "2015-08-01"
#      'id[1]/@root': ""
      'code/@code': "CONC"
      'code/@codeSystem': "2.16.840.1.113883.5.6"
      'code/@codeSystemName': "HL7ActClass"
      'code/@displayName': "Concern"
      'statusCode/@code': "active"
#      'effectiveTime/low/@value': "20200429"
    - xPath: "entry[1]/act/entryRelationship"
      count: 2
    - xPath: "entry[1]/act/entryRelationship[1]/"
      '@typeCode': "SUBJ"
      'observation/@classCode': "OBS"
      'observation/@moodCode': "EVN"
    - xPath: "entry[1]/act/entryRelationship[1]/observation/templateId"
      count: 2
    - xPath: "entry[1]/act/entryRelationship[1]/observation/id"
      count: 1
    - xPath: "entry[1]/act/entryRelationship[1]/observation/"
      'templateId[1]/@root': "2.16.840.1.113883.10.20.22.4.4"
      'templateId[2]/@root': "2.16.840.1.113883.10.20.22.4.4"
      'templateId[2]/@extension': "2015-08-01"
      'id[1]/@root': "2.16.840.1.113883.1.1.1.1"
#      'id[1]/@extension': "d2572357187"
      'code/@code': "282291009"
      'code/@codeSystem': "2.16.840.1.113883.6.96"
      'code/@codeSystemName': "SNOMED-CT"
      'code/@displayName': "Diagnosis"
      'code/translation/@code': "29308-4"
      'code/translation/@codeSystem': "2.16.840.1.113883.6.1"
      'code/translation/@codeSystemName': "LOINC"
      'code/translation/@displayName': "Diagnosis"
      'statusCode/@code': "completed"
#      'effectiveTime/low/@value': "20200429"
    - xPath: "entry[1]/act/entryRelationship[1]/observation/value/translation"
      count: 1
    #- xPath: "entry[1]/act/entryRelationship[1]/observation/value/"
     # '@type': "CD"
      #'@code': "840544004"
      #'@codeSystem': "2.16.840.1.113883.6.96"
      #'@codeSystemName': "sct"
      #'@displayName': "Suspected disease caused by 2019-nCoV"
      #'translation/@code': "Z20.828"
      #'translation/@codeSystem': "2.16.840.1.113883.6.90"
      #'translation/@codeSystemName': "icd-10-cm"
      #'translation/@displayName': "Contact with and (suspected) exposure to other viral communicable diseases"
    - xPath: "entry[1]/act/entryRelationship[2]/"
      '@typeCode': "RSON"
      'observation/@classCode': "OBS"
      'observation/@moodCode': "EVN"
      'observation/@negationInd': "false"
    - xPath: "entry[1]/act/entryRelationship[2]/observation/templateId"
      count: 3
    - xPath: "entry[1]/act/entryRelationship[2]/observation/id"
      count: 1
    - xPath: "entry[1]/act/entryRelationship[2]/observation/"
      'templateId[1]/@root': "2.16.840.1.113883.10.20.22.4.4"
      'templateId[2]/@root': "2.16.840.1.113883.10.20.22.4.4"
      'templateId[2]/@extension': "2015-08-01"
      'templateId[3]/@root': "2.16.840.1.113883.10.20.15.2.3.3"
      'templateId[3]/@extension': "2016-12-01"
      'id[1]/@root': "2.16.840.1.113883.1.1.1.1"
#      'id[1]/@extension': "d2572357189"
      'code/@code': "282291009"
      'code/@codeSystem': "2.16.840.1.113883.6.96"
      'code/@codeSystemName': "SNOMED-CT"
      'code/@displayName': "Diagnosis"
      'code/translation/@code': "29308-4"
      'code/translation/@codeSystem': "2.16.840.1.113883.6.1"
      'code/translation/@codeSystemName': "LOINC"
      'code/translation/@displayName': "Diagnosis"
      'statusCode/@code': "completed"
 #     'effectiveTime/low/@value': "20200429"
    - xPath: "entry[1]/act/entryRelationship[2]/observation/value/"
      '@type': "CD"
      '@code': "U07.1"
      '@codeSystem': "2.16.840.1.113883.6.90"
      '@codeSystemName': "icd-10-cm"
#      '@displayName': "Suspected disease caused by 2019-nCoV"
#      '@valueSet': "2.16.840.1.114222.4.11.7508"
#      '@valueSetVersion': "2020-07-09"
    - xPath: "entry[2]/act/entryRelationship"
      count: 1
    - xPath: "entry[2]/act/entryRelationship[1]/"
      '@typeCode': "SUBJ"
      'observation/@classCode': "OBS"
      'observation/@moodCode': "EVN"
    - xPath: "entry[2]/act/entryRelationship[1]/observation/templateId"
      count: 2
    - xPath: "entry[2]/act/entryRelationship[1]/observation/id"
      count: 1
    - xPath: "entry[2]/act/entryRelationship[1]/observation/"
      'templateId[1]/@root': "2.16.840.1.113883.10.20.22.4.4"
      'templateId[2]/@root': "2.16.840.1.113883.10.20.22.4.4"
      'templateId[2]/@extension': "2015-08-01"
      'id[1]/@root': "2.16.840.1.113883.1.1.1.1"
#      'id[1]/@extension': "d2572357189"
      'code/@code': "282291009"
      'code/@codeSystem': "2.16.840.1.113883.6.96"
      'code/@codeSystemName': "SNOMED-CT"
      'code/@displayName': "Diagnosis"
      'code/translation/@code': "29308-4"
      'code/translation/@codeSystem': "2.16.840.1.113883.6.1"
      'code/translation/@codeSystemName': "LOINC"
      'code/translation/@displayName': "Diagnosis"
      'statusCode/@code': "completed"
#      'effectiveTime/low/@value': "20200429"
    - xPath: "entry[2]/act/entryRelationship[1]/observation/value/translation"
      count: 0
    - xPath: "entry[2]/act/entryRelationship[1]/observation/value/"
      '@type': "CD"
      '@code': "444316004"
      '@codeSystem': "2.16.840.1.113883.6.96"
      '@codeSystemName': "sct"
      '@displayName': "Seasonal allergy (disorder)"
      #'translation/@code': "Z20.828"
      #'translation/@codeSystem': "2.16.840.1.113883.6.90"
      #'translation/@codeSystemName': "icd-10-cm"
      #'translation/@displayName': "Contact with and (suspected) exposure to other viral communicable diseases"
  eCR-problem-withAndWithoutTriggerCode:
    testData:
      ClientDataToBeSaved: "R4/Misc/ClientDetails/ClientDataEntry1.json"
      SystemLaunchPayload: "R4/Misc/SystemLaunchPayload/systemLaunchRequest.json"
      BaseXPath: "/ClinicalDocument/component/structuredBody/component[1]/section/"
    resourceMappingData:
      Patient:
      - params: "12742571"
        responseFilePath: "R4/Patient/Patient_12742571.json"
      Encounter:
      - params: "97953900"
        responseFilePath: "R4/Encounter/Encounter_withOneParticipant.json"
      Practitioner:
      - params: "11817978"
        responseFilePath: "R4/Practitioner/Practitioner_11817978.json"
      Organization:
      - params: "675844"
        responseFilePath: "R4/Organization/Organization.json"
      Condition:
      - params:
          patient: "12742571"
        responseFilePath: "R4/Condition/ConditionWithAndWithoutTriggerCodes.json"
      Observation:
      - params:
          patient: "12742571"
          category: "laboratory"
        responseFilePath: "R4/Observation/ObservationLaboratory.json"
    otherMappingData:
      metadata: "R4/Misc/MetaData_r4.json"
      token: "R4/Misc/AccessToken.json"
      default: "R4/Misc/NoDataFound_Default.json"
    validate:
    - xPath: "text/table/tbody/tr"
      count: 8
    - xPath: "text/table/"
  #    'tbody/tr[6]/td[1]/content': "Hyperlipidemia (disorder)"
  #    'tbody/tr[6]/td[2]/content': "Active"
      'tbody/tr[8]/td[1]/content': "Suspected coronavirus infection (situation)"
      'tbody/tr[8]/td[2]/content': "Active"
    - xPath: "entry"
      count: 8
    - xPath: "entry[1]/act/id"
      count: 1
    - xPath: "entry[1]/act/"
#      'id[1]/@root': ""
      'statusCode/@code': "active"
#      'effectiveTime/low/@value': "20200427"
    - xPath: "entry[1]/act/entryRelationship"
      count: 1
    - xPath: "entry[1]/act/entryRelationship[1]/observation/id"
      count: 1
    - xPath: "entry[1]/act/entryRelationship[1]/observation/"
      'id[1]/@root': "2.16.840.1.113883.1.1.1.1"
#      'id[1]/@extension': "d2572356773"
      'statusCode/@code': "completed"
#      'effectiveTime/low/@value': "20200427"
    - xPath: "entry[6]/act/entryRelationship[1]/observation/value/translation"
      count: 1
    - xPath: "entry[6]/act/entryRelationship[1]/observation/value/"
      '@type': "CD"
      '@code': "186747009"
      '@codeSystem': "2.16.840.1.113883.6.96"
      '@codeSystemName': "sct"
#      '@displayName': "Hyperlipidemia (disorder)"
      #'translation/@code': "B34.2"
      #'translation/@codeSystem': "2.16.840.1.113883.6.90"
      #'translation/@codeSystemName': "icd-10-cm"
      #'translation/@displayName': "Coronavirus infection, unspecified"
    #- xPath: "entry[1]/act/entryRelationship[2]/observation/"
      #'statusCode/@code': "completed"
#      'effectiveTime/low/@value': "20200427"
    #- xPath: "entry[1]/act/entryRelationship[2]/observation/value/"
      #'@type': "CD"
      #'@code': "B34.2"
      #'@codeSystem': "2.16.840.1.113883.6.90"
      #'@codeSystemName': "icd-10-cm"
#      '@displayName': "Coronavirus infection, unspecified"
      #'@valueSet': "2.16.840.1.114222.4.11.7508"
      #'@valueSetVersion': "2020-07-09"
    - xPath: "entry[8]/act/entryRelationship"
      count: 1
    - xPath: "entry[8]/act/entryRelationship[1]/observation/id"
      count: 1
    - xPath: "entry[8]/act/entryRelationship[1]/observation/"
      'id[1]/@root': "2.16.840.1.113883.1.1.1.1"
#      'id[1]/@extension': "d2572356771"
      'statusCode/@code': "completed"
#      'effectiveTime/low/@value': "20200425"
    - xPath: "entry[8]/act/entryRelationship[1]/observation/value/translation"
      count: 1
    - xPath: "entry[8]/act/entryRelationship[1]/observation/value/"
      '@type': "CD"
      '@code': "700217006"
      '@codeSystem': "2.16.840.1.113883.6.96"
      '@codeSystemName': "sct"
      '@displayName': "Suspected coronavirus infection (situation)"
      'translation/@code': "Z20.828"
      'translation/@codeSystem': "2.16.840.1.113883.6.90"
      'translation/@codeSystemName': "icd-10-cm"
      'translation/@displayName': "Contact with and (suspected) exposure to other viral communicable diseases"
  eCR-problem-emptySection:
    testData:
      ClientDataToBeSaved: "R4/Misc/ClientDetails/ClientDataEntry1.json"
      SystemLaunchPayload: "R4/Misc/SystemLaunchPayload/systemLaunchRequest.json"
      BaseXPath: "/ClinicalDocument/component/structuredBody/component[1]/section/"
    resourceMappingData:
      Patient:
        - params: "12742571"
          responseFilePath: "R4/Patient/Patient_12742571.json"
      Encounter:
        - params: "97953900"
          responseFilePath: "R4/Encounter/Encounter_withOneParticipant.json"
      Practitioner:
        - params: "11817978"
          responseFilePath: "R4/Practitioner/Practitioner_11817978.json"
      Organization:
        - params: "675844"
          responseFilePath: "R4/Organization/Organization.json"
      Observation:
        - params:
            patient: "12742571"
            category: "laboratory"
          responseFilePath: "R4/Observation/ObservationLaboratory.json"
    otherMappingData:
      metadata: "R4/Misc/MetaData_r4.json"
      token: "R4/Misc/AccessToken.json"
      default: "R4/Misc/NoDataFound_Default.json"
    validate:
      - xPath: ""
        '@nullFlavor': "NI"
        'templateId[1]/@root': "2.16.840.1.113883.10.20.22.2.5.1"
        'templateId[2]/@root': "2.16.840.1.113883.10.20.22.2.5.1"
        'templateId[2]/@extension': "2015-08-01"
        'code/@code': "11450-4"
        'code/@codeSystem': "2.16.840.1.113883.6.1"
        'code/@codeSystemName': "LOINC"
        'code/@displayName': "PROBLEM LIST"
        'title': "PROBLEMS - DIAGNOSES"
        'text': "No Problem Information"